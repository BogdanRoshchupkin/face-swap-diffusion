# Face Swap Diffusion

![–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç](results/top3_realistic/with_lora.png)

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—É—é —Å–º–µ–Ω—É –ª–∏—Ü–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Stable Diffusion XL –∏ —Ç–µ—Ö–Ω–∏–∫–∏ LoRA (Low-Rank Adaptation). –¶–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ñ–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—É—é –∑–∞–º–µ–Ω—É –ª–∏—Ü–∞, —Å–æ—Ö—Ä–∞–Ω—è—é—â—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –ø—Ä–∏ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–∏ –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–∞.

### ‚úÖ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
- –£—Å–ø–µ—à–Ω–æ –¥–æ–æ–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å SDXL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoRA –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –∏–∑ 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª–∏—Ü–∞
- –°–æ–∑–¥–∞–Ω—ã —Ñ–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞ —Å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –≤–æ–ª–æ—Å–∞–º–∏, –≥–ª–∞–∑–∞–º–∏, —Ç–µ–∫—Å—Ç—É—Ä–æ–π –∫–æ–∂–∏ –∏ —á–µ—Ä—Ç–∞–º–∏ –ª–∏—Ü–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–±–µ–≥–∞–Ω–∏–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º, —Ç–∞–∫–∏—Ö –∫–∞–∫ "–ø–ª–∞—Å—Ç–∏–ª–∏–Ω–æ–≤—ã–µ" –ª–∏—Ü–∞ –∏–ª–∏ –Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–Ω–≤–µ–π–µ—Ä—ã –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üß† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Stable Diffusion XL** —Å **–¥–æ–æ–±—É—á–µ–Ω–∏–µ–º LoRA**:

1. **Stable Diffusion XL (SDXL)**: –ú–æ—â–Ω–∞—è –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∞—è –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫
2. **LoRA (Low-Rank Adaptation)**: –¢–µ—Ö–Ω–∏–∫–∞ –¥–æ–æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∫ –Ω–æ–≤—ã–º –∑–∞–¥–∞—á–∞–º —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏:

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**:
   - –°–æ–±—Ä–∞–Ω–æ 10 –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ª–∏—Ü–∞ (7 –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö + 3 –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å –∑–µ—Ä–∫–∞–ª—å–Ω—ã–º –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π –æ—Å–≤–µ—â–µ–Ω–∏—è)
   - –°–æ–∑–¥–∞–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –æ–±—Ä–∞–∑—Ü—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –∏–∑ –∫–ª–∞—Å—Å–∞ "woman" –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

2. **–î–æ–æ–±—É—á–µ–Ω–∏–µ LoRA**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ Kohya SS –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è LoRA
   - –î–æ–±–∞–≤–ª–µ–Ω–æ —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ "myface" –¥–ª—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ —Å —Ü–µ–ª–µ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å—é
   - –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —á–µ—Ä—Ç –ª–∏—Ü–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

3. **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å**:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ "myface"
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –ª–∏—Ü–µ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## üñºÔ∏è –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü—Ä–∏–º–µ—Ä—ã –î–æ –∏ –ü–æ—Å–ª–µ

–ü—Ä–∏–º–µ—Ä—ã, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–µ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏ –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞:

**–ü—Ä–∏–º–µ—Ä 1:**  
–ë–∞–∑–æ–≤–∞—è vs. LoRA –º–æ–¥–µ–ª—å  
![–î–æ 1](results/before_after/baseline%20(1).png) ![–ü–æ—Å–ª–µ 1](results/before_after/with_lora%20(1).png)

**–ü—Ä–∏–º–µ—Ä 3:**  
–ë–∞–∑–æ–≤–∞—è vs. LoRA –º–æ–¥–µ–ª—å  
![–î–æ 3](results/before_after/baseline%20(3).png) ![–ü–æ—Å–ª–µ 3](results/before_after/with_lora%20(3).png)

**–ü—Ä–∏–º–µ—Ä 5:**  
–ë–∞–∑–æ–≤–∞—è vs. LoRA –º–æ–¥–µ–ª—å  
![–î–æ 5](results/before_after/baseline%20(5).png) ![–ü–æ—Å–ª–µ 5](results/before_after/with_lora%20(5).png)

### –õ—É—á—à–∏–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ —Ñ–æ—Ç–æ—Ä–µ–∞–ª–∏–∑–º –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏:

![–†–µ–∑—É–ª—å—Ç–∞—Ç 1](results/top3_realistic/with_lora.png)
![–†–µ–∑—É–ª—å—Ç–∞—Ç 2](results/top3_realistic/with_lora%20(1).png)
![–†–µ–∑—É–ª—å—Ç–∞—Ç 3](results/top3_realistic/myface_woman.png)

## üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- PyTorch
- Diffusers
- Transformers
- –î—Ä—É–≥–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤ –Ω–æ—É—Ç–±—É–∫–∞—Ö

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

–î–ª—è –æ–±—É—á–µ–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π LoRA –¥–ª—è –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞:

1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ 5-10 –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ü–µ–ª–µ–≤–æ–≥–æ –ª–∏—Ü–∞
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä—ã –≤ –ø–∞–ø–∫–µ `data/captions`)
3. –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑—Ü—ã —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ (–º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞ "woman")
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—É—á–∞—é—â–∏–π –Ω–æ—É—Ç–±—É–∫: `notebooks/01_training.ipynb`
5. –°–ª–µ–¥—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ –Ω–æ—É—Ç–±—É–∫–µ

### –ò–Ω—Ñ–µ—Ä–µ–Ω—Å

> **–í–∞–∂–Ω–æ:** –ü—Ä–æ–µ–∫—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –º–æ–¥–µ–ª–∏ text-to-image (—Ç–µ–∫—Å—Ç –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∑–∞–º–µ–Ω–æ–π –ª–∏—Ü–∞ –≤—ã –ù–ï –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –∞ –≤–≤–æ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∂–µ–ª–∞–µ–º–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ "myface".

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∑–∞–º–µ–Ω–æ–π –ª–∏—Ü–∞ —Å –ø–æ–º–æ—â—å—é –æ–±—É—á–µ–Ω–Ω–æ–π LoRA:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ—É—Ç–±—É–∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞: `notebooks/02_inference.ipynb`
2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å LoRA
3. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏, –≤–∫–ª—é—á–∞—é—â–∏–º–∏ —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ "myface"

–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç:
- "myface woman, professional portrait, soft lighting"
- "myface woman, outdoors, natural light, bokeh"

#### –°–æ–≤–µ—Ç—ã –ø–æ –ø—Ä–æ–º–ø—Ç–∞–º

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–∞–∏–ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
- –í–∫–ª—é—á–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ "myface" –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞ –∑–∞–º–µ–Ω—ã –ª–∏—Ü–∞
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø—Ä–æ–º–ø—Ç—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç—ã–º–∏, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å –º–æ–¥–µ–ª–∏ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –ª–∏—Ü–µ
- –í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `<lora:myface:1.0>` –¥–ª—è —è–≤–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ LoRA
- –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ (0.7-1.0) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏

## üìö –†–µ—Å—É—Ä—Å—ã

–û–±—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ç–µ—Ö–Ω–∏–∫–∞—Ö –∏–∑ —ç—Ç–∏—Ö –ø–æ–ª–µ–∑–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤:
- [–¢—É—Ç–æ—Ä–∏–∞–ª All Your Tech AI](https://www.youtube.com/watch?v=y2J7EZUk_a0)
- [–¢—É—Ç–æ—Ä–∏–∞–ª Control Alt AI](https://www.youtube.com/watch?v=_F39RbO3tYo)

–§—Ä–µ–π–º–≤–æ—Ä–∫, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è:
- [–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Kohya SS –Ω–∞ GitHub](https://github.com/bmaltais/kohya_ss)
- [Kohya Colab –æ—Ç hollowstrawberry](https://github.com/hollowstrawberry/kohya-colab) - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Kohya SS –¥–ª—è Google Colab

### üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –Ω–æ—É—Ç–±—É–∫–∏ –∏–∑ Kohya Colab

–î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –Ω–æ—É—Ç–±—É–∫–∏ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è [hollowstrawberry/kohya-colab](https://github.com/hollowstrawberry/kohya-colab):

1. **Dataset Maker** - –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–µ–π (captions) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ BLIP. –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—Å—Ç–∏–ª –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

2. **Lora Trainer XL** - –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è LoRA –Ω–∞ –±–∞–∑–µ –º–æ–¥–µ–ª–∏ Stable Diffusion XL. –≠—Ç–æ—Ç –Ω–æ—É—Ç–±—É–∫ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –ø—Ä—è–º–æ –≤ Google Colab.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö –Ω–æ—É—Ç–±—É–∫–æ–≤ –æ—Ç hollowstrawberry –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —Å—Ä–µ–¥—ã –æ–±—É—á–µ–Ω–∏—è –∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–∞–∏–ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
face-swap-diffusion/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ original/                # 7 –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ augmented/               # 3 –∑–µ—Ä–∫–∞–ª—å–Ω—ã—Ö + –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–∏ –æ—Å–≤–µ—â–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ captions/                # –ü–æ–¥–ø–∏—Å–∏ –∫ –¥–∞—Ç–∞—Å–µ—Ç—É
‚îÇ   ‚îî‚îÄ‚îÄ regularization_samples/  # –í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü—ã –∫–ª–∞—Å—Å–∞ "woman"
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ glam_test_task_data-05.safetensors   # –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ø–æ–π–Ω—Ç LoRA
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ 01_training.ipynb        # Colab-–Ω–æ—É—Ç–±—É–∫ —Å –æ–±—É—á–µ–Ω–∏–µ–º –Ω–∞ Kohya-SS
‚îÇ   ‚îî‚îÄ‚îÄ 02_inference.ipynb       # Jupyter-–Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ LoRA
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îú‚îÄ‚îÄ before_after/            # –¢—Ä–∏ –ø–∞—Ä—ã "–¥–æ ‚Üî –ø–æ—Å–ª–µ" (–±–µ–∑/—Å LoRA)
‚îÇ   ‚îî‚îÄ‚îÄ top3_realistic/          # –¢—Ä–∏ —Å–∞–º—ã—Ö —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞
‚îî‚îÄ‚îÄ README.md
```